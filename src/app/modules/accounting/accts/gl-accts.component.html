<div class="absolute inset-0 flex flex-col overflow-y-auto overflow-auto" cdkScrollable>
    <div class="flex-auto sm:p-5">
        <div class="h-[calc(100vh)-200px] ">
            <mat-drawer-container class="flex-col">
                <mat-drawer class="w-[450px]" #drawer [opened]="false" mode="over" [position]="'end'" [disableClose]="false">
                    <mat-card class="m-2">
                        <div class="flex flex-col w-full filter-article filter-interactive text-gray-700">
                            <div class="bg-slate-600 text-justify m-2 p-2 text-white h-10 text-2xl border-l-4 border-gray-400"
                                mat-dialog-title>
                                {{ sTitle }}
                            </div>
                        </div>

                        <form [formGroup]="accountsForm" class="form">
                            <div class="div flex flex-col grow">
                                <section class="flex flex-col md:flex-row m-1">
                                    <div class="flex flex-col grow">
                                        <mat-form-field class="m-1 flex-start">
                                            <mat-label class="ml-2 text-base">Account</mat-label>
                                            <input #myInput matInput placeholder="Account" formControlName="account" />
                                        </mat-form-field>
                                    </div>

                                    <div class="flex flex-col grow">
                                        <mat-form-field class="m-1 flex-start">
                                            <mat-label class="ml-2 text-base">Child Account</mat-label>
                                            <input #myInput matInput placeholder="Child Account"
                                                formControlName="child" />
                                        </mat-form-field>
                                    </div>
                                    <div class="flex flex-col grow">
                                        <!-- <mat-form-field class="m-1 flex-start">
                                                <mat-label class="ml-2 text-base">Parent Account</mat-label>
                                                <input #myInput matInput placeholder="Parent Acocunt"
                                                    formControlName="parent_account" />
                                            </mat-form-field> -->
                                        
                                        <mat-checkbox color="primary" class="mt-5" formControlName="parent_account">
                                            Parent Account
                                        </mat-checkbox>
                                    </div>

                                </section>

                                <div class="flex flex-col grow">
                                    <mat-form-field class="m-1 flex-start">
                                        <mat-label class="ml-2 text-base">Description</mat-label>
                                        <input #myInput matInput placeholder="Description"
                                            formControlName="description" />
                                    </mat-form-field>
                                </div>

                                <section class="flex flex-col md:flex-row">

                                    <mat-form-field class="m-1 grow">
                                        <mat-label class="ml-2 text-base">Account Type</mat-label>
                                        <mat-select placeholder="Type" formControlName="type"
                                            (selectionChange)="changeType($event)">
                                            @for (item of types; track item) {
                                            <mat-option [value]="item.type"> {{ item.type }} </mat-option>
                                            }
                                        </mat-select>
                                    </mat-form-field>


                                    <mat-form-field class="m-1 grow">
                                        <mat-label class="ml-2 text-base">Sub Type</mat-label>
                                        <mat-select placeholder="Sub Type" formControlName="sub_type"
                                            (selectionChange)="changeType($event)">
                                            @for (item of types; track item) 
                                            { <mat-option [value]="item.type"> {{
                                                item.type }} </mat-option> 
                                            }
                                        </mat-select>
                                    </mat-form-field>

                                </section>

                                <div class="flex flex-col grow">
                                    <mat-form-field class="m-1 flex-start">
                                        <mat-label class="ml-2 text-base">Comments</mat-label>
                                        <input #myInput matInput placeholder="" formControlName="comments" />
                                    </mat-form-field>
                                </div>

                            </div>
                        </form>

                        <div mat-dialog-actions>
                            <button mat-icon-button color="primary" class="m-1" (click)="onUpdate($event)"
                                matTooltip="Update"
                                aria-label="Button that displays a tooltip when focused or hovered over">                                
                                <mat-icon>update</mat-icon>
                            </button>
                            <button mat-icon-button color="primary" class="m-1" (click)="onCreate($event)"
                                matTooltip="Add"
                                aria-label="Button that displays a tooltip when focused or hovered over">                                
                                <mat-icon>add</mat-icon>
                            </button>
                            <button mat-icon-button color="primary" class="m-1" (click)="onDelete($event)"
                                matTooltip="Delete"
                                aria-label="Button that displays a tooltip when focused or hovered over">                                
                                <mat-icon>delete</mat-icon>
                            </button>
                            <button mat-icon-button color="primary" class="m-1" (click)="closeDrawer()"
                                matTooltip="Close"
                                aria-label="Button that displays a tooltip when focused or hovered over">
                                
                                <mat-icon>close</mat-icon>
                            </button>
                        </div>
                    </mat-card>
                </mat-drawer>
                <ng-container>
                @if (data$ | async; as rows) {
                    <grid-menubar (notifyParentRefresh)="onRefresh()" (notifyParentAdd)="onAdd()"
                        (notifyParentDelete)="onDeleteSelection()" (notifyParentUpdate)="onUpdateSelection()">
                    </grid-menubar>

                    <div class="flex flex-col">
                        <dx-data-grid class="h-[550px]" id="id" [wordWrapEnabled]="false" [dataSource]="rows"
                            [showColumnLines]="true" [showRowLines]="true" [showBorders]="true"
                            [focusedRowEnabled]="true" [repaintChangesOnly]="true"
                            (onCellDblClick)="onDoubleClicked($event)" keyExpr="child">

                            <dxo-search-panel [visible]="true" [highlightCaseSensitive]="true"></dxo-search-panel>
                            <dxo-group-panel [visible]="true"></dxo-group-panel>
                            <dxo-grouping [autoExpandAll]="true"></dxo-grouping>
                            <dxo-filter-row [visible]="false"></dxo-filter-row>
                            <dxo-scrolling mode="virtual"></dxo-scrolling>

                            <dxi-column dataField="account" width="100"> </dxi-column>
                            <dxi-column dataField="child" width="100"> </dxi-column>
                            <dxi-column dataField="parent_account" caption="Parent" width="70"></dxi-column>
                            <dxi-column dataField="description" width="400"></dxi-column>
                            <dxi-column dataField="sub_type" width="100"></dxi-column>
                            <dxi-column dataField="type" caption="Type" width="100"></dxi-column>
                            <dxi-column dataField="update_date" width="100"></dxi-column>
                            <dxi-column dataField="update_user" width="100"></dxi-column>
                            <dxi-column dataField="comments"></dxi-column>

                            <dxo-master-detail [enabled]="false" template="detail"> </dxo-master-detail>
                            <div *dxTemplate="let journal of 'detail'">
                                <gl-detail [account]="journal.data.account"></gl-detail>
                            </div>
                        </dx-data-grid>
                    </div>
                    } @else
                    {
                    <div class="text-center">No Data found ... refresh the page...</div>
                }
                </ng-container>
            </mat-drawer-container>
        </div>
    </div>
</div>