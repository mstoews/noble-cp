<div class="absolute inset-0 flex flex-col min-w-0 overflow-y-auto -px-20" cdkScrollable>
    <!-- Main -->
    <div class="flex-auto p-6 sm:p-10">
        <div class="h-full border-gray-300 rounded-2xl">
            <mat-drawer-container class="flex-col h-full">
                <mat-drawer class="md:w-[600px] w-full bg-white-100" #drawer [opened]="false" mode="over"
                    [position]="'end'" [disableClose]="false">
                    @if (types$ | async; as types) {
                    <div>
                        <form [formGroup]="accountsForm">

                            <mat-card>
                                <div class="bg-slate-600 text-justify pt-2 text-white h-10 text-2xl m-2"
                                    mat-dialog-title>
                                    {{ sTitle }}
                                </div>

                                <div
                                    class="flex flex-col w-full text-gray-700 max-w-140 filter-article filter-interactive">

                                    <div class="flex flex-col m-1">
                                        <section class="flex flex-col md:flex-row">
                                            <div class="flex flex-col grow">
                                                <mat-form-field class="m-1 form-element grow" appearance="outline">
                                                    <mat-label class="ml-2 text-base dark:text-gray-100">Account
                                                        Code</mat-label>
                                                    <input matInput placeholder="Account" formControlName="account" />
                                                </mat-form-field>
                                            </div>
                                            <div class="flex flex-col grow">
                                                <mat-checkbox type="checkbox" formControlName="parent_account">Parent
                                                    Account</mat-checkbox>
                                            </div>
                                        </section>

                                        <section class="flex flex-col md:flex-row">
                                            <div class="flex flex-col grow">
                                                <mat-form-field class="m-1 form-element grow" appearance="outline">
                                                    <mat-label class="ml-2 text-base dark:text-gray-100">Sub
                                                        Account</mat-label>
                                                    <input matInput placeholder="Sub Account"
                                                        formControlName="child_account" />
                                                </mat-form-field>
                                            </div>
                                        </section>

                                        <mat-form-field class="m-1 form-element grow" appearance="outline">
                                            <mat-select (selectionChange)="selectionType($event)" placeholder="Type"
                                                formControlName="type">
                                                @for (type of types; track type) {
                                                <mat-option [value]="type.type"> {{ type.type }} </mat-option>
                                                }
                                            </mat-select>
                                        </mat-form-field>

                                        <div class="flex flex-col grow">
                                            <mat-form-field class="m-1 form-element" appearance="outline">
                                                <mat-label class="ml-2 text-base dark:text-gray-100">Long
                                                    Description</mat-label>
                                                <input matInput placeholder="Account Description"
                                                    formControlName="description" />
                                            </mat-form-field>
                                        </div>

                                        <div class="flex flex-col grow">
                                            <mat-form-field class="m-1 form-element" appearance="outline">
                                                <mat-label
                                                    class="ml-2 text-base dark:text-gray-100">Comments</mat-label>
                                                <input matInput placeholder="Comments" formControlName="comments" />
                                            </mat-form-field>
                                        </div>

                                        <div mat-dialog-actions>
                                            <div mat-dialog-actions>
                                                <button mat-raised-button color="primary" class="m-1"
                                                    (click)="onUpdate()" matTooltip="Save"
                                                    aria-label="Button that displays a tooltip when focused or hovered over">
                                                    Update
                                                    <mat-icon>update</mat-icon>
                                                </button>
                                                <button mat-raised-button color="primary" class="m-1"
                                                    (click)="onCreate($event)" matTooltip="Save"
                                                    aria-label="Button that displays a tooltip when focused or hovered over">
                                                    Add
                                                    <mat-icon>add</mat-icon>
                                                </button>
                                                <button mat-raised-button color="primary" class="m-1"
                                                    (click)="onDelete($event)" matTooltip="Save"
                                                    aria-label="Button that displays a tooltip when focused or hovered over">
                                                    Delete
                                                    <mat-icon>delete</mat-icon>
                                                </button>
                                                <button mat-raised-button color="primary" class="m-1"
                                                    (click)="closeDrawer()" matTooltip="Save"
                                                    aria-label="Button that displays a tooltip when focused or hovered over">
                                                    Cancel
                                                    <mat-icon>close</mat-icon>
                                                </button>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </mat-card>
                        </form>
                    </div>
                }
                </mat-drawer>

                <ng-container>
                    @if (accounts$ | async; as rows) {
                    <div class="flex flex-col h-full">
                        <dx-tree-list dataSource]="rows" keyExpr="account" parentIdExpr="account" dataStructure="tree"
                            [showRowLines]="true" [showBorders]="true" [columnAutoWidth]="true">
                            <dxo-scrolling mode="standard"></dxo-scrolling>
                            <dxo-paging [enabled]="true" [pageSize]="10"> </dxo-paging>
                            <dxo-pager [showPageSizeSelector]="true" [allowedPageSizes]="[5, 10, 20]" [showInfo]="true">
                            </dxo-pager>
                            <!-- <dxi-column dataField="id"       width="0"  dataType="string"></dxi-column> -->
                            <!-- <dxi-column dataField="account"       width="120"  dataType="string"></dxi-column>
                                <dxi-column dataField="child_account" width="120"  caption="Sub Account" dataType="string"></dxi-column> -->
                            <dxi-column dataField="description" dataType="string"></dxi-column>
                            <dxi-column dataField="type" width="120" dataType="string"></dxi-column>
                            <dxi-column dataField="balance" width="120" dataType="decimal" alignment="right"
                                [customizeText]="formatNumber"></dxi-column>

                            <dxi-column dataField="update_user" width="120" alignment="right"
                                dataType="string"></dxi-column>
                            <dxi-column dataField="update_date" width="120" alignment="right"
                                dataType="date"></dxi-column>
                        </dx-tree-list>

                        <button mat-fab (click)="add()" class="fixed bottom-30 right-16 rounded-full" color="primary"
                            aria-label="Add Fab">
                            <mat-icon>add</mat-icon>
                        </button>
                    </div>
                    }
                </ng-container>
            </mat-drawer-container>
        </div>
    </div>
</div>
